/**
 * lunr - http://lunrjs.com - A bit like Solr, but much smaller and not as bright - 2.3.9
 * Copyright (C) 2020 Oliver Nightingale
 * @license MIT
 */
(function(){var n=function(t){var i=new n.Builder;return i.pipeline.add(n.trimmer,n.stopWordFilter,n.stemmer),i.searchPipeline.add(n.stemmer),t.call(i,i),i.build()};n.version="2.3.9";
/*!
 * lunr.utils
 * Copyright (C) 2020 Oliver Nightingale
 */
n.utils={};n.utils.warn=function(n){return function(t){n.console&&console.warn&&console.warn(t)}}(this);n.utils.asString=function(n){return n===void 0||n===null?"":n.toString()};n.utils.clone=function(n){var i,f,r,u,t;if(n===null||n===undefined)return n;for(i=Object.create(null),f=Object.keys(n),r=0;r<f.length;r++){if(u=f[r],t=n[u],Array.isArray(t)){i[u]=t.slice();continue}if(typeof t=="string"||typeof t=="number"||typeof t=="boolean"){i[u]=t;continue}throw new TypeError("clone is not deep and does not support nested objects");}return i};n.FieldRef=function(n,t,i){this.docRef=n;this.fieldName=t;this._stringValue=i};n.FieldRef.joiner="/";n.FieldRef.fromString=function(t){var i=t.indexOf(n.FieldRef.joiner),r,u;if(i===-1)throw"malformed field ref string";return r=t.slice(0,i),u=t.slice(i+1),new n.FieldRef(u,r,t)};n.FieldRef.prototype.toString=function(){return this._stringValue==undefined&&(this._stringValue=this.fieldName+n.FieldRef.joiner+this.docRef),this._stringValue};
/*!
 * lunr.Set
 * Copyright (C) 2020 Oliver Nightingale
 */
n.Set=function(n){if(this.elements=Object.create(null),n){this.length=n.length;for(var t=0;t<this.length;t++)this.elements[n[t]]=!0}else this.length=0};n.Set.complete={intersect:function(n){return n},union:function(){return this},contains:function(){return!0}};n.Set.empty={intersect:function(){return this},union:function(n){return n},contains:function(){return!1}};n.Set.prototype.contains=function(n){return!!this.elements[n]};n.Set.prototype.intersect=function(t){var r,u,f,o=[],i,e;if(t===n.Set.complete)return this;if(t===n.Set.empty)return t;for(this.length<t.length?(r=this,u=t):(r=t,u=this),f=Object.keys(r.elements),i=0;i<f.length;i++)e=f[i],e in u.elements&&o.push(e);return new n.Set(o)};n.Set.prototype.union=function(t){return t===n.Set.complete?n.Set.complete:t===n.Set.empty?this:new n.Set(Object.keys(this.elements).concat(Object.keys(t.elements)))};n.idf=function(n,t){var i=0,r,u;for(r in n)r!="_index"&&(i+=Object.keys(n[r]).length);return u=(t-i+.5)/(i+.5),Math.log(1+Math.abs(u))};n.Token=function(n,t){this.str=n||"";this.metadata=t||{}};n.Token.prototype.toString=function(){return this.str};n.Token.prototype.update=function(n){return this.str=n(this.str,this.metadata),this};n.Token.prototype.clone=function(t){return t=t||function(n){return n},new n.Token(t(this.str,this.metadata),this.metadata)};
/*!
 * lunr.tokenizer
 * Copyright (C) 2020 Oliver Nightingale
 */
n.tokenizer=function(t,i){var r,u,c,s,f;if(t==null||t==undefined)return[];if(Array.isArray(t))return t.map(function(t){return new n.Token(n.utils.asString(t).toLowerCase(),n.utils.clone(i))});var e=t.toString().toLowerCase(),h=e.length,o=[];for(r=0,u=0;r<=h;r++)c=e.charAt(r),s=r-u,(c.match(n.tokenizer.separator)||r==h)&&(s>0&&(f=n.utils.clone(i)||{},f.position=[u,s],f.index=o.length,o.push(new n.Token(e.slice(u,r),f))),u=r+1);return o};n.tokenizer.separator=/[\s\-]+/;
/*!
 * lunr.Pipeline
 * Copyright (C) 2020 Oliver Nightingale
 */
n.Pipeline=function(){this._stack=[]};n.Pipeline.registeredFunctions=Object.create(null);n.Pipeline.registerFunction=function(t,i){i in this.registeredFunctions&&n.utils.warn("Overwriting existing registered function: "+i);t.label=i;n.Pipeline.registeredFunctions[t.label]=t};n.Pipeline.warnIfFunctionNotRegistered=function(t){var i=t.label&&t.label in this.registeredFunctions;i||n.utils.warn("Function is not registered with pipeline. This may cause problems when serialising the index.\n",t)};n.Pipeline.load=function(t){var i=new n.Pipeline;return t.forEach(function(t){var r=n.Pipeline.registeredFunctions[t];if(r)i.add(r);else throw new Error("Cannot load unregistered function: "+t);}),i};n.Pipeline.prototype.add=function(){var t=Array.prototype.slice.call(arguments);t.forEach(function(t){n.Pipeline.warnIfFunctionNotRegistered(t);this._stack.push(t)},this)};n.Pipeline.prototype.after=function(t,i){n.Pipeline.warnIfFunctionNotRegistered(i);var r=this._stack.indexOf(t);if(r==-1)throw new Error("Cannot find existingFn");r=r+1;this._stack.splice(r,0,i)};n.Pipeline.prototype.before=function(t,i){n.Pipeline.warnIfFunctionNotRegistered(i);var r=this._stack.indexOf(t);if(r==-1)throw new Error("Cannot find existingFn");this._stack.splice(r,0,i)};n.Pipeline.prototype.remove=function(n){var t=this._stack.indexOf(n);t!=-1&&this._stack.splice(t,1)};n.Pipeline.prototype.run=function(n){for(var e,r,i,t,u,o=this._stack.length,f=0;f<o;f++){for(e=this._stack[f],r=[],i=0;i<n.length;i++)if(t=e(n[i],i,n),t!==null&&t!==void 0&&t!=="")if(Array.isArray(t))for(u=0;u<t.length;u++)r.push(t[u]);else r.push(t);n=r}return n};n.Pipeline.prototype.runString=function(t,i){var r=new n.Token(t,i);return this.run([r]).map(function(n){return n.toString()})};n.Pipeline.prototype.reset=function(){this._stack=[]};n.Pipeline.prototype.toJSON=function(){return this._stack.map(function(t){return n.Pipeline.warnIfFunctionNotRegistered(t),t.label})};
/*!
 * lunr.Vector
 * Copyright (C) 2020 Oliver Nightingale
 */
n.Vector=function(n){this._magnitude=0;this.elements=n||[]};n.Vector.prototype.positionForIndex=function(n){if(this.elements.length==0)return 0;for(var r=0,f=this.elements.length/2,u=f-r,t=Math.floor(u/2),i=this.elements[t*2];u>1;){if(i<n&&(r=t),i>n&&(f=t),i==n)break;u=f-r;t=r+Math.floor(u/2);i=this.elements[t*2]}return i==n?t*2:i>n?t*2:i<n?(t+1)*2:void 0};n.Vector.prototype.insert=function(n,t){this.upsert(n,t,function(){throw"duplicate index";})};n.Vector.prototype.upsert=function(n,t,i){this._magnitude=0;var r=this.positionForIndex(n);this.elements[r]==n?this.elements[r+1]=i(this.elements[r+1],t):this.elements.splice(r,0,n,t)};n.Vector.prototype.magnitude=function(){var t,r,n,i;if(this._magnitude)return this._magnitude;for(t=0,r=this.elements.length,n=1;n<r;n+=2)i=this.elements[n],t+=i*i;return this._magnitude=Math.sqrt(t)};n.Vector.prototype.dot=function(n){for(var o=0,f=this.elements,e=n.elements,s=f.length,h=e.length,r=0,u=0,t=0,i=0;t<s&&i<h;)r=f[t],u=e[i],r<u?t+=2:r>u?i+=2:r==u&&(o+=f[t+1]*e[i+1],t+=2,i+=2);return o};n.Vector.prototype.similarity=function(n){return this.dot(n)/this.magnitude()||0};n.Vector.prototype.toArray=function(){for(var t=new Array(this.elements.length/2),n=1,i=0;n<this.elements.length;n+=2,i++)t[i]=this.elements[n];return t};n.Vector.prototype.toJSON=function(){return this.elements};
/*!
 * lunr.stemmer
 * Copyright (C) 2020 Oliver Nightingale
 * Includes code from - http://tartarus.org/~martin/PorterStemmer/js.txt
 */
n.stemmer=function(){var e={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},o={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},i="[aeiouy]",n="[^aeiou][^aeiouy]*",t=i+"[aeiou]*",s="^("+n+")?"+t+n,h="^("+n+")?"+t+n+"("+t+")?$",c="^("+n+")?"+t+n+t+n,l="^("+n+")?"+i,u=new RegExp(s),r=new RegExp(c),a=new RegExp(h),v=new RegExp(l),y=/^(.+?)(ss|i)es$/,p=/^(.+?)([^s])s$/,w=/^(.+?)eed$/,b=/^(.+?)(ed|ing)$/,f=/.$/,k=/(at|bl|iz)$/,d=new RegExp("([^aeiouylsz])\\1$"),g=new RegExp("^"+n+i+"[^aeiouwxy]$"),nt=/^(.+?[^aeiou])y$/,tt=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,it=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,rt=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,ut=/^(.+?)(s|t)(ion)$/,ft=/^(.+?)e$/,et=/ll$/,ot=new RegExp("^"+n+i+"[^aeiouwxy]$"),st=function(n){var i,l,c,t,s,st,ht,h;return n.length<3?n:(c=n.substr(0,1),c=="y"&&(n=c.toUpperCase()+n.substr(1)),t=y,s=p,t.test(n)?n=n.replace(t,"$1$2"):s.test(n)&&(n=n.replace(s,"$1$2")),t=w,s=b,t.test(n)?(h=t.exec(n),t=u,t.test(h[1])&&(t=f,n=n.replace(t,""))):s.test(n)&&(h=s.exec(n),i=h[1],s=v,s.test(i)&&(n=i,s=k,st=d,ht=g,s.test(n)?n=n+"e":st.test(n)?(t=f,n=n.replace(t,"")):ht.test(n)&&(n=n+"e"))),t=nt,t.test(n)&&(h=t.exec(n),i=h[1],n=i+"i"),t=tt,t.test(n)&&(h=t.exec(n),i=h[1],l=h[2],t=u,t.test(i)&&(n=i+e[l])),t=it,t.test(n)&&(h=t.exec(n),i=h[1],l=h[2],t=u,t.test(i)&&(n=i+o[l])),t=rt,s=ut,t.test(n)?(h=t.exec(n),i=h[1],t=r,t.test(i)&&(n=i)):s.test(n)&&(h=s.exec(n),i=h[1]+h[2],s=r,s.test(i)&&(n=i)),t=ft,t.test(n)&&(h=t.exec(n),i=h[1],t=r,s=a,st=ot,(t.test(i)||s.test(i)&&!st.test(i))&&(n=i)),t=et,s=r,t.test(n)&&s.test(n)&&(t=f,n=n.replace(t,"")),c=="y"&&(n=c.toLowerCase()+n.substr(1)),n)};return function(n){return n.update(st)}}();n.Pipeline.registerFunction(n.stemmer,"stemmer");
/*!
 * lunr.stopWordFilter
 * Copyright (C) 2020 Oliver Nightingale
 */
n.generateStopWordFilter=function(n){var t=n.reduce(function(n,t){return n[t]=t,n},{});return function(n){if(n&&t[n.toString()]!==n.toString())return n}};n.stopWordFilter=n.generateStopWordFilter(["a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"]);n.Pipeline.registerFunction(n.stopWordFilter,"stopWordFilter");
/*!
 * lunr.trimmer
 * Copyright (C) 2020 Oliver Nightingale
 */
n.trimmer=function(n){return n.update(function(n){return n.replace(/^\W+/,"").replace(/\W+$/,"")})};n.Pipeline.registerFunction(n.trimmer,"trimmer");
/*!
 * lunr.TokenSet
 * Copyright (C) 2020 Oliver Nightingale
 */
n.TokenSet=function(){this.final=!1;this.edges={};this.id=n.TokenSet._nextId;n.TokenSet._nextId+=1};n.TokenSet._nextId=1;n.TokenSet.fromArray=function(t){for(var i=new n.TokenSet.Builder,r=0,u=t.length;r<u;r++)i.insert(t[r]);return i.finish(),i.root};n.TokenSet.fromClause=function(t){return"editDistance"in t?n.TokenSet.fromFuzzyString(t.term,t.editDistance):n.TokenSet.fromString(t.term)};n.TokenSet.fromFuzzyString=function(t,i){for(var l=new n.TokenSet,u=[{node:l,editsRemaining:i,str:t}],r,h,f,e,o,a,c,s;u.length;)(r=u.pop(),r.str.length>0&&(h=r.str.charAt(0),h in r.node.edges?f=r.node.edges[h]:(f=new n.TokenSet,r.node.edges[h]=f),r.str.length==1&&(f.final=!0),u.push({node:f,editsRemaining:r.editsRemaining,str:r.str.slice(1)})),r.editsRemaining!=0)&&("*"in r.node.edges?e=r.node.edges["*"]:(e=new n.TokenSet,r.node.edges["*"]=e),r.str.length==0&&(e.final=!0),u.push({node:e,editsRemaining:r.editsRemaining-1,str:r.str}),r.str.length>1&&u.push({node:r.node,editsRemaining:r.editsRemaining-1,str:r.str.slice(1)}),r.str.length==1&&(r.node.final=!0),r.str.length>=1&&("*"in r.node.edges?o=r.node.edges["*"]:(o=new n.TokenSet,r.node.edges["*"]=o),r.str.length==1&&(o.final=!0),u.push({node:o,editsRemaining:r.editsRemaining-1,str:r.str.slice(1)})),r.str.length>1&&(a=r.str.charAt(0),c=r.str.charAt(1),c in r.node.edges?s=r.node.edges[c]:(s=new n.TokenSet,r.node.edges[c]=s),r.str.length==1&&(s.final=!0),u.push({node:s,editsRemaining:r.editsRemaining-1,str:a+r.str.slice(2)})));return l};n.TokenSet.fromString=function(t){for(var u,e,f,i=new n.TokenSet,s=i,r=0,o=t.length;r<o;r++)u=t[r],e=r==o-1,u=="*"?(i.edges[u]=i,i.final=e):(f=new n.TokenSet,f.final=e,i.edges[u]=f,i=f);return s};n.TokenSet.prototype.toArray=function(){for(var u=[],i=[{prefix:"",node:this}],t,r;i.length;){var n=i.pop(),f=Object.keys(n.node.edges),e=f.length;for(n.node.final&&(n.prefix.charAt(0),u.push(n.prefix)),t=0;t<e;t++)r=f[t],i.push({prefix:n.prefix.concat(r),node:n.node.edges[r]})}return u};n.TokenSet.prototype.toString=function(){var n,i,u;if(this._str)return this._str;var t=this.final?"1":"0",r=Object.keys(this.edges).sort(),f=r.length;for(n=0;n<f;n++)i=r[n],u=this.edges[i],t=t+i+u.id;return t};n.TokenSet.prototype.intersect=function(t){for(var h=new n.TokenSet,i=undefined,s=[{qNode:t,output:h,node:this}],f,e,o,u;s.length;){i=s.pop();var c=Object.keys(i.qNode.edges),p=c.length,l=Object.keys(i.node.edges),w=l.length;for(f=0;f<p;f++)for(e=c[f],o=0;o<w;o++)if(u=l[o],u==e||e=="*"){var a=i.node.edges[u],v=i.qNode.edges[e],y=a.final&&v.final,r=undefined;u in i.output.edges?(r=i.output.edges[u],r.final=r.final||y):(r=new n.TokenSet,r.final=y,i.output.edges[u]=r);s.push({qNode:v,output:r,node:a})}}return h};n.TokenSet.Builder=function(){this.previousWord="";this.root=new n.TokenSet;this.uncheckedNodes=[];this.minimizedNodes={}};n.TokenSet.Builder.prototype.insert=function(t){var r,f=0,i,u,e;if(t<this.previousWord)throw new Error("Out of order word insertion");for(i=0;i<t.length&&i<this.previousWord.length;i++){if(t[i]!=this.previousWord[i])break;f++}for(this.minimize(f),r=this.uncheckedNodes.length==0?this.root:this.uncheckedNodes[this.uncheckedNodes.length-1].child,i=f;i<t.length;i++)u=new n.TokenSet,e=t[i],r.edges[e]=u,this.uncheckedNodes.push({parent:r,char:e,child:u}),r=u;r.final=!0;this.previousWord=t};n.TokenSet.Builder.prototype.finish=function(){this.minimize(0)};n.TokenSet.Builder.prototype.minimize=function(n){for(var t,i,r=this.uncheckedNodes.length-1;r>=n;r--)t=this.uncheckedNodes[r],i=t.child.toString(),i in this.minimizedNodes?t.parent.edges[t.char]=this.minimizedNodes[i]:(t.child._str=i,this.minimizedNodes[i]=t.child),this.uncheckedNodes.pop()};
/*!
 * lunr.Index
 * Copyright (C) 2020 Oliver Nightingale
 */
n.Index=function(n){this.invertedIndex=n.invertedIndex;this.fieldVectors=n.fieldVectors;this.tokenSet=n.tokenSet;this.fields=n.fields;this.pipeline=n.pipeline};n.Index.prototype.search=function(t){return this.query(function(i){var r=new n.QueryParser(t,i);r.parse()})};n.Index.prototype.query=function(t){for(var y,st,ht,p,w,k,f,d,g,i,a,o,c,dt,ut,ft,et,l=new n.Query(this.fields),s=Object.create(null),nt=Object.create(null),ot=Object.create(null),e=Object.create(null),h=Object.create(null),r=0;r<this.fields.length;r++)nt[this.fields[r]]=new n.Vector;for(t.call(l,l),r=0;r<l.clauses.length;r++){var u=l.clauses[r],tt=null,it=n.Set.empty;for(tt=u.usePipeline?this.pipeline.runString(u.term,{fields:u.fields}):[u.term],y=0;y<tt.length;y++){if(st=tt[y],u.term=st,ht=n.TokenSet.fromClause(u),p=this.tokenSet.intersect(ht).toArray(),p.length===0&&u.presence===n.Query.presence.REQUIRED){for(f=0;f<u.fields.length;f++)i=u.fields[f],e[i]=n.Set.empty;break}for(w=0;w<p.length;w++){var b=p[w],ct=this.invertedIndex[b],gt=ct._index;for(f=0;f<u.fields.length;f++){var i=u.fields[f],lt=ct[i],rt=Object.keys(lt),at=b+"/"+i,vt=new n.Set(rt);if(u.presence==n.Query.presence.REQUIRED&&(it=it.union(vt),e[i]===undefined&&(e[i]=n.Set.complete)),u.presence==n.Query.presence.PROHIBITED){h[i]===undefined&&(h[i]=n.Set.empty);h[i]=h[i].union(vt);continue}if(nt[i].upsert(gt,u.boost,function(n,t){return n+t}),!ot[at]){for(k=0;k<rt.length;k++){var yt=rt[k],a=new n.FieldRef(yt,i),pt=lt[yt],wt;(wt=s[a])===undefined?s[a]=new n.MatchData(b,i,pt):wt.add(b,i,pt)}ot[at]=!0}}}}if(u.presence===n.Query.presence.REQUIRED)for(f=0;f<u.fields.length;f++)i=u.fields[f],e[i]=e[i].intersect(it)}for(d=n.Set.complete,g=n.Set.empty,r=0;r<this.fields.length;r++)i=this.fields[r],e[i]&&(d=d.intersect(e[i])),h[i]&&(g=g.union(h[i]));var v=Object.keys(s),bt=[],kt=Object.create(null);if(l.isNegated())for(v=Object.keys(this.fieldVectors),r=0;r<v.length;r++)a=v[r],o=n.FieldRef.fromString(a),s[a]=new n.MatchData;for(r=0;r<v.length;r++)(o=n.FieldRef.fromString(v[r]),c=o.docRef,d.contains(c))&&(g.contains(c)||(dt=this.fieldVectors[o],ut=nt[o.fieldName].similarity(dt),(ft=kt[c])!==undefined?(ft.score+=ut,ft.matchData.combine(s[o])):(et={ref:c,score:ut,matchData:s[o]},kt[c]=et,bt.push(et))));return bt.sort(function(n,t){return t.score-n.score})};n.Index.prototype.toJSON=function(){var t=Object.keys(this.invertedIndex).sort().map(function(n){return[n,this.invertedIndex[n]]},this),i=Object.keys(this.fieldVectors).map(function(n){return[n,this.fieldVectors[n].toJSON()]},this);return{version:n.version,fields:this.fields,fieldVectors:i,invertedIndex:t,pipeline:this.pipeline.toJSON()}};n.Index.load=function(t){var r={},e={},o=t.fieldVectors,s=Object.create(null),h=t.invertedIndex,f=new n.TokenSet.Builder,l=n.Pipeline.load(t.pipeline),i;for(t.version!=n.version&&n.utils.warn("Version mismatch when loading serialised index. Current version of lunr '"+n.version+"' does not match serialized index '"+t.version+"'"),i=0;i<o.length;i++){var u=o[i],a=u[0],v=u[1];e[a]=new n.Vector(v)}for(i=0;i<h.length;i++){var u=h[i],c=u[0],y=u[1];f.insert(c);s[c]=y}return f.finish(),r.fields=t.fields,r.fieldVectors=e,r.invertedIndex=s,r.tokenSet=f.root,r.pipeline=l,new n.Index(r)};
/*!
 * lunr.Builder
 * Copyright (C) 2020 Oliver Nightingale
 */
n.Builder=function(){this._ref="id";this._fields=Object.create(null);this._documents=Object.create(null);this.invertedIndex=Object.create(null);this.fieldTermFrequencies={};this.fieldLengths={};this.tokenizer=n.tokenizer;this.pipeline=new n.Pipeline;this.searchPipeline=new n.Pipeline;this.documentCount=0;this._b=.75;this._k1=1.2;this.termIndex=0;this.metadataWhitelist=[]};n.Builder.prototype.ref=function(n){this._ref=n};n.Builder.prototype.field=function(n,t){if(/\//.test(n))throw new RangeError("Field '"+n+"' contains illegal character '/'");this._fields[n]=t||{}};n.Builder.prototype.b=function(n){this._b=n<0?0:n>1?1:n};n.Builder.prototype.k1=function(n){this._k1=n};n.Builder.prototype.add=function(t,i){var f=t[this._ref],o=Object.keys(this._fields),s,c,r,l,a,v,e,b;for(this._documents[f]=i||{},this.documentCount+=1,s=0;s<o.length;s++){var u=o[s],w=this._fields[u].extractor,k=w?w(t):t[u],d=this.tokenizer(k,{fields:[u]}),y=this.pipeline.run(d),p=new n.FieldRef(f,u),h=Object.create(null);for(this.fieldTermFrequencies[p]=h,this.fieldLengths[p]=0,this.fieldLengths[p]+=y.length,c=0;c<y.length;c++){if(r=y[c],h[r]==undefined&&(h[r]=0),h[r]+=1,this.invertedIndex[r]==undefined){for(l=Object.create(null),l._index=this.termIndex,this.termIndex+=1,a=0;a<o.length;a++)l[o[a]]=Object.create(null);this.invertedIndex[r]=l}for(this.invertedIndex[r][u][f]==undefined&&(this.invertedIndex[r][u][f]=Object.create(null)),v=0;v<this.metadataWhitelist.length;v++)e=this.metadataWhitelist[v],b=r.metadata[e],this.invertedIndex[r][u][f][e]==undefined&&(this.invertedIndex[r][u][f][e]=[]),this.invertedIndex[r][u][f][e].push(b)}}};n.Builder.prototype.calculateAverageFieldLengths=function(){for(var e,i,o,f,s=Object.keys(this.fieldLengths),h=s.length,r={},u={},t=0;t<h;t++)e=n.FieldRef.fromString(s[t]),i=e.fieldName,u[i]||(u[i]=0),u[i]+=1,r[i]||(r[i]=0),r[i]+=this.fieldLengths[e];for(o=Object.keys(this._fields),t=0;t<o.length;t++)f=o[t],r[f]=r[f]/u[f];this.averageFieldLength=r};n.Builder.prototype.createFieldVectors=function(){for(var r,s={},h=Object.keys(this.fieldTermFrequencies),w=h.length,e=Object.create(null),o=0;o<w;o++){var i=n.FieldRef.fromString(h[o]),c=i.fieldName,b=this.fieldLengths[i],l=new n.Vector,a=this.fieldTermFrequencies[i],v=Object.keys(a),k=v.length,d=this._fields[c].boost||1,g=this._documents[i.docRef].boost||1;for(r=0;r<k;r++){var t=v[r],y=a[t],nt=this.invertedIndex[t]._index,u,f,p;e[t]===undefined?(u=n.idf(this.invertedIndex[t],this.documentCount),e[t]=u):u=e[t];f=u*(this._k1+1)*y/(this._k1*(1-this._b+this._b*(b/this.averageFieldLength[c]))+y);f*=d;f*=g;p=Math.round(f*1e3)/1e3;l.insert(nt,p)}s[i]=l}this.fieldVectors=s};n.Builder.prototype.createTokenSet=function(){this.tokenSet=n.TokenSet.fromArray(Object.keys(this.invertedIndex).sort())};n.Builder.prototype.build=function(){return this.calculateAverageFieldLengths(),this.createFieldVectors(),this.createTokenSet(),new n.Index({invertedIndex:this.invertedIndex,fieldVectors:this.fieldVectors,tokenSet:this.tokenSet,fields:Object.keys(this._fields),pipeline:this.searchPipeline})};n.Builder.prototype.use=function(n){var t=Array.prototype.slice.call(arguments,1);t.unshift(this);n.apply(this,t)};n.MatchData=function(n,t,i){for(var u,f=Object.create(null),e=Object.keys(i||{}),r=0;r<e.length;r++)u=e[r],f[u]=i[u].slice();this.metadata=Object.create(null);n!==undefined&&(this.metadata[n]=Object.create(null),this.metadata[n][t]=f)};n.MatchData.prototype.combine=function(n){for(var t,o,u,i,s,f,r,h=Object.keys(n.metadata),e=0;e<h.length;e++)for(t=h[e],o=Object.keys(n.metadata[t]),this.metadata[t]==undefined&&(this.metadata[t]=Object.create(null)),u=0;u<o.length;u++)for(i=o[u],s=Object.keys(n.metadata[t][i]),this.metadata[t][i]==undefined&&(this.metadata[t][i]=Object.create(null)),f=0;f<s.length;f++)r=s[f],this.metadata[t][i][r]=this.metadata[t][i][r]==undefined?n.metadata[t][i][r]:this.metadata[t][i][r].concat(n.metadata[t][i][r])};n.MatchData.prototype.add=function(n,t,i){var f,u,r;if(!(n in this.metadata)){this.metadata[n]=Object.create(null);this.metadata[n][t]=i;return}if(!(t in this.metadata[n])){this.metadata[n][t]=i;return}for(f=Object.keys(i),u=0;u<f.length;u++)r=f[u],this.metadata[n][t][r]=r in this.metadata[n][t]?this.metadata[n][t][r].concat(i[r]):i[r]};n.Query=function(n){this.clauses=[];this.allFields=n};n.Query.wildcard=new String("*");n.Query.wildcard.NONE=0;n.Query.wildcard.LEADING=1;n.Query.wildcard.TRAILING=2;n.Query.presence={OPTIONAL:1,REQUIRED:2,PROHIBITED:3};n.Query.prototype.clause=function(t){return"fields"in t||(t.fields=this.allFields),"boost"in t||(t.boost=1),"usePipeline"in t||(t.usePipeline=!0),"wildcard"in t||(t.wildcard=n.Query.wildcard.NONE),t.wildcard&n.Query.wildcard.LEADING&&t.term.charAt(0)!=n.Query.wildcard&&(t.term="*"+t.term),t.wildcard&n.Query.wildcard.TRAILING&&t.term.slice(-1)!=n.Query.wildcard&&(t.term=""+t.term+"*"),"presence"in t||(t.presence=n.Query.presence.OPTIONAL),this.clauses.push(t),this};n.Query.prototype.isNegated=function(){for(var t=0;t<this.clauses.length;t++)if(this.clauses[t].presence!=n.Query.presence.PROHIBITED)return!1;return!0};n.Query.prototype.term=function(t,i){if(Array.isArray(t))return t.forEach(function(t){this.term(t,n.utils.clone(i))},this),this;var r=i||{};return r.term=t.toString(),this.clause(r),this};n.QueryParseError=function(n,t,i){this.name="QueryParseError";this.message=n;this.start=t;this.end=i};n.QueryParseError.prototype=new Error;n.QueryLexer=function(n){this.lexemes=[];this.str=n;this.length=n.length;this.pos=0;this.start=0;this.escapeCharPositions=[]};n.QueryLexer.prototype.run=function(){for(var t=n.QueryLexer.lexText;t;)t=t(this)};n.QueryLexer.prototype.sliceString=function(){for(var n=[],t=this.start,i=this.pos,r=0;r<this.escapeCharPositions.length;r++)i=this.escapeCharPositions[r],n.push(this.str.slice(t,i)),t=i+1;return n.push(this.str.slice(t,this.pos)),this.escapeCharPositions.length=0,n.join("")};n.QueryLexer.prototype.emit=function(n){this.lexemes.push({type:n,str:this.sliceString(),start:this.start,end:this.pos});this.start=this.pos};n.QueryLexer.prototype.escapeCharacter=function(){this.escapeCharPositions.push(this.pos-1);this.pos+=1};n.QueryLexer.prototype.next=function(){if(this.pos>=this.length)return n.QueryLexer.EOS;var t=this.str.charAt(this.pos);return this.pos+=1,t};n.QueryLexer.prototype.width=function(){return this.pos-this.start};n.QueryLexer.prototype.ignore=function(){this.start==this.pos&&(this.pos+=1);this.start=this.pos};n.QueryLexer.prototype.backup=function(){this.pos-=1};n.QueryLexer.prototype.acceptDigitRun=function(){var t,i;do t=this.next(),i=t.charCodeAt(0);while(i>47&&i<58);t!=n.QueryLexer.EOS&&this.backup()};n.QueryLexer.prototype.more=function(){return this.pos<this.length};n.QueryLexer.EOS="EOS";n.QueryLexer.FIELD="FIELD";n.QueryLexer.TERM="TERM";n.QueryLexer.EDIT_DISTANCE="EDIT_DISTANCE";n.QueryLexer.BOOST="BOOST";n.QueryLexer.PRESENCE="PRESENCE";n.QueryLexer.lexField=function(t){return t.backup(),t.emit(n.QueryLexer.FIELD),t.ignore(),n.QueryLexer.lexText};n.QueryLexer.lexTerm=function(t){return t.width()>1&&(t.backup(),t.emit(n.QueryLexer.TERM)),t.ignore(),t.more()?n.QueryLexer.lexText:void 0};n.QueryLexer.lexEditDistance=function(t){return t.ignore(),t.acceptDigitRun(),t.emit(n.QueryLexer.EDIT_DISTANCE),n.QueryLexer.lexText};n.QueryLexer.lexBoost=function(t){return t.ignore(),t.acceptDigitRun(),t.emit(n.QueryLexer.BOOST),n.QueryLexer.lexText};n.QueryLexer.lexEOS=function(t){t.width()>0&&t.emit(n.QueryLexer.TERM)};n.QueryLexer.termSeparator=n.tokenizer.separator;n.QueryLexer.lexText=function(t){for(;;){var i=t.next();if(i==n.QueryLexer.EOS)return n.QueryLexer.lexEOS;if(i.charCodeAt(0)==92){t.escapeCharacter();continue}if(i==":")return n.QueryLexer.lexField;if(i=="~")return t.backup(),t.width()>0&&t.emit(n.QueryLexer.TERM),n.QueryLexer.lexEditDistance;if(i=="^")return t.backup(),t.width()>0&&t.emit(n.QueryLexer.TERM),n.QueryLexer.lexBoost;if(i=="+"&&t.width()===1||i=="-"&&t.width()===1)return t.emit(n.QueryLexer.PRESENCE),n.QueryLexer.lexText;if(i.match(n.QueryLexer.termSeparator))return n.QueryLexer.lexTerm}};n.QueryParser=function(t,i){this.lexer=new n.QueryLexer(t);this.query=i;this.currentClause={};this.lexemeIdx=0};n.QueryParser.prototype.parse=function(){this.lexer.run();this.lexemes=this.lexer.lexemes;for(var t=n.QueryParser.parseClause;t;)t=t(this);return this.query};n.QueryParser.prototype.peekLexeme=function(){return this.lexemes[this.lexemeIdx]};n.QueryParser.prototype.consumeLexeme=function(){var n=this.peekLexeme();return this.lexemeIdx+=1,n};n.QueryParser.prototype.nextClause=function(){var n=this.currentClause;this.query.clause(n);this.currentClause={}};n.QueryParser.parseClause=function(t){var i=t.peekLexeme(),r;if(i!=undefined)switch(i.type){case n.QueryLexer.PRESENCE:return n.QueryParser.parsePresence;case n.QueryLexer.FIELD:return n.QueryParser.parseField;case n.QueryLexer.TERM:return n.QueryParser.parseTerm;default:r="expected either a field or a term, found "+i.type;i.str.length>=1&&(r+=" with value '"+i.str+"'");throw new n.QueryParseError(r,i.start,i.end);}};n.QueryParser.parsePresence=function(t){var i=t.consumeLexeme(),u,r;if(i!=undefined){switch(i.str){case"-":t.currentClause.presence=n.Query.presence.PROHIBITED;break;case"+":t.currentClause.presence=n.Query.presence.REQUIRED;break;default:r="unrecognised presence operator'"+i.str+"'";throw new n.QueryParseError(r,i.start,i.end);}if(u=t.peekLexeme(),u==undefined){r="expecting term or field, found nothing";throw new n.QueryParseError(r,i.start,i.end);}switch(u.type){case n.QueryLexer.FIELD:return n.QueryParser.parseField;case n.QueryLexer.TERM:return n.QueryParser.parseTerm;default:r="expecting term or field, found '"+u.type+"'";throw new n.QueryParseError(r,u.start,u.end);}}};n.QueryParser.parseField=function(t){var i=t.consumeLexeme(),f,u,r;if(i!=undefined){if(t.query.allFields.indexOf(i.str)==-1){f=t.query.allFields.map(function(n){return"'"+n+"'"}).join(", ");r="unrecognised field '"+i.str+"', possible fields: "+f;throw new n.QueryParseError(r,i.start,i.end);}if(t.currentClause.fields=[i.str],u=t.peekLexeme(),u==undefined){r="expecting term, found nothing";throw new n.QueryParseError(r,i.start,i.end);}switch(u.type){case n.QueryLexer.TERM:return n.QueryParser.parseTerm;default:r="expecting term, found '"+u.type+"'";throw new n.QueryParseError(r,u.start,u.end);}}};n.QueryParser.parseTerm=function(t){var r=t.consumeLexeme(),i,u;if(r!=undefined){if(t.currentClause.term=r.str.toLowerCase(),r.str.indexOf("*")!=-1&&(t.currentClause.usePipeline=!1),i=t.peekLexeme(),i==undefined){t.nextClause();return}switch(i.type){case n.QueryLexer.TERM:return t.nextClause(),n.QueryParser.parseTerm;case n.QueryLexer.FIELD:return t.nextClause(),n.QueryParser.parseField;case n.QueryLexer.EDIT_DISTANCE:return n.QueryParser.parseEditDistance;case n.QueryLexer.BOOST:return n.QueryParser.parseBoost;case n.QueryLexer.PRESENCE:return t.nextClause(),n.QueryParser.parsePresence;default:u="Unexpected lexeme type '"+i.type+"'";throw new n.QueryParseError(u,i.start,i.end);}}};n.QueryParser.parseEditDistance=function(t){var r=t.consumeLexeme(),f,i,u;if(r!=undefined){if(f=parseInt(r.str,10),isNaN(f)){u="edit distance must be numeric";throw new n.QueryParseError(u,r.start,r.end);}if(t.currentClause.editDistance=f,i=t.peekLexeme(),i==undefined){t.nextClause();return}switch(i.type){case n.QueryLexer.TERM:return t.nextClause(),n.QueryParser.parseTerm;case n.QueryLexer.FIELD:return t.nextClause(),n.QueryParser.parseField;case n.QueryLexer.EDIT_DISTANCE:return n.QueryParser.parseEditDistance;case n.QueryLexer.BOOST:return n.QueryParser.parseBoost;case n.QueryLexer.PRESENCE:return t.nextClause(),n.QueryParser.parsePresence;default:u="Unexpected lexeme type '"+i.type+"'";throw new n.QueryParseError(u,i.start,i.end);}}};n.QueryParser.parseBoost=function(t){var r=t.consumeLexeme(),f,i,u;if(r!=undefined){if(f=parseInt(r.str,10),isNaN(f)){u="boost must be numeric";throw new n.QueryParseError(u,r.start,r.end);}if(t.currentClause.boost=f,i=t.peekLexeme(),i==undefined){t.nextClause();return}switch(i.type){case n.QueryLexer.TERM:return t.nextClause(),n.QueryParser.parseTerm;case n.QueryLexer.FIELD:return t.nextClause(),n.QueryParser.parseField;case n.QueryLexer.EDIT_DISTANCE:return n.QueryParser.parseEditDistance;case n.QueryLexer.BOOST:return n.QueryParser.parseBoost;case n.QueryLexer.PRESENCE:return t.nextClause(),n.QueryParser.parsePresence;default:u="Unexpected lexeme type '"+i.type+"'";throw new n.QueryParseError(u,i.start,i.end);}}},function(n,t){typeof define=="function"&&define.amd?define(t):typeof exports=="object"?module.exports=t():n.lunr=t()}(this,function(){return n})})();